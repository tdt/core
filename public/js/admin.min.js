(function(e,t){typeof exports=="object"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t(e)})(this,function(e){function r(e){this._targetElement=e;this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0}}function i(e){var t,n,r,i,s,f,c,h,p,d,m,g,y=[],b=this;if(this._options.steps){t=[];for(n=0,r=this._options.steps.length;n<r;n++){i=this._options.steps[n];i.step=n+1;typeof i.element=="string"&&(i.element=document.querySelector(i.element));y.push(i)}}else{t=e.querySelectorAll("*[data-intro]");if(t.length<1)return!1;for(n=0,s=t.length;n<s;n++){f=t[n];c=parseInt(f.getAttribute("data-step"),10);c>0&&(y[c-1]={element:f,intro:f.getAttribute("data-intro"),step:parseInt(f.getAttribute("data-step"),10),tooltipClass:f.getAttribute("data-tooltipClass"),position:f.getAttribute("data-position")||this._options.tooltipPosition})}h=0;for(n=0,s=t.length;n<s;n++){f=t[n];if(f.getAttribute("data-step")==null){for(;;){if(typeof y[h]=="undefined")break;h++}y[h]={element:f,intro:f.getAttribute("data-intro"),step:h+1,tooltipClass:f.getAttribute("data-tooltipClass"),position:f.getAttribute("data-position")||this._options.tooltipPosition}}}}p=[];for(d=0;d<y.length;d++)y[d]&&p.push(y[d]);y=p;y.sort(function(e,t){return e.step-t.step});b._introItems=y;if(v.call(b,e)){o.call(b);m=e.querySelector(".introjs-skipbutton"),g=e.querySelector(".introjs-nextbutton");b._onKeyDown=function(t){if(t.keyCode===27&&b._options.exitOnEsc==1){a.call(b,e);b._introExitCallback!=undefined&&b._introExitCallback.call(b)}else if(t.keyCode===37)u.call(b);else if(t.keyCode===39||t.keyCode===13){o.call(b);t.preventDefault?t.preventDefault():t.returnValue=!1}};b._onResize=function(){l.call(b,document.querySelector(".introjs-helperLayer"))};if(window.addEventListener){this._options.keyboardNavigation&&window.addEventListener("keydown",b._onKeyDown,!0);window.addEventListener("resize",b._onResize,!0)}else if(document.attachEvent){this._options.keyboardNavigation&&document.attachEvent("onkeydown",b._onKeyDown);document.attachEvent("onresize",b._onResize)}}return!1}function s(e){this._currentStep=e-2;typeof this._introItems!="undefined"&&o.call(this)}function o(){var e;typeof this._currentStep=="undefined"?this._currentStep=0:++this._currentStep;if(this._introItems.length<=this._currentStep){typeof this._introCompleteCallback=="function"&&this._introCompleteCallback.call(this);a.call(this,this._targetElement);return}e=this._introItems[this._currentStep];typeof this._introBeforeChangeCallback!="undefined"&&this._introBeforeChangeCallback.call(this,e.element);c.call(this,e)}function u(){var e;if(this._currentStep===0)return!1;e=this._introItems[--this._currentStep];typeof this._introBeforeChangeCallback!="undefined"&&this._introBeforeChangeCallback.call(this,e.element);c.call(this,e)}function a(e){var t,n,r,i,s=e.querySelector(".introjs-overlay");s.style.opacity=0;setTimeout(function(){s.parentNode&&s.parentNode.removeChild(s)},500);t=e.querySelector(".introjs-helperLayer");t&&t.parentNode.removeChild(t);n=document.querySelector(".introjs-showElement");n&&(n.className=n.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""));r=document.querySelectorAll(".introjs-fixParent");if(r&&r.length>0)for(i=r.length-1;i>=0;i--)r[i].className=r[i].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown);this._currentStep=undefined}function f(e,t,n){var r,i,s;t.style.top=null;t.style.right=null;t.style.bottom=null;t.style.left=null;if(!this._introItems[this._currentStep])return;r="";i=this._introItems[this._currentStep];typeof i.tooltipClass=="string"?r=i.tooltipClass:r=this._options.tooltipClass;t.className=("introjs-tooltip "+r).replace(/^\s+|\s+$/g,"");r=this._options.tooltipClass;s=this._introItems[this._currentStep].position;switch(s){case"top":t.style.left="15px";t.style.top="-"+(m(t).height+10)+"px";n.className="introjs-arrow bottom";break;case"right":t.style.left=m(e).width+20+"px";n.className="introjs-arrow left";break;case"left":t.style.top="15px";t.style.right=m(e).width+20+"px";n.className="introjs-arrow right";break;case"bottom":default:t.style.bottom="-"+(m(t).height+10)+"px";n.className="introjs-arrow top"}}function l(e){var t;if(e){if(!this._introItems[this._currentStep])return;t=m(this._introItems[this._currentStep].element);e.setAttribute("style","width: "+(t.width+10)+"px; "+"height:"+(t.height+10)+"px; "+"top:"+(t.top-5)+"px;"+"left: "+(t.left-5)+"px;")}}function c(e){var t,n,r,i,s,c,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;typeof this._introChangeCallback!="undefined"&&this._introChangeCallback.call(this,e.element);t=this,n=document.querySelector(".introjs-helperLayer"),r=m(e.element);if(n!=null){i=n.querySelector(".introjs-helperNumberLayer"),s=n.querySelector(".introjs-tooltiptext"),c=n.querySelector(".introjs-arrow"),v=n.querySelector(".introjs-tooltip"),g=n.querySelector(".introjs-skipbutton"),y=n.querySelector(".introjs-prevbutton"),b=n.querySelector(".introjs-nextbutton");v.style.opacity=0;l.call(t,n);w=document.querySelectorAll(".introjs-fixParent");if(w&&w.length>0)for(E=w.length-1;E>=0;E--)w[E].className=w[E].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");S=document.querySelector(".introjs-showElement");S.className=S.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");t._lastShowElementTimer&&clearTimeout(t._lastShowElementTimer);t._lastShowElementTimer=setTimeout(function(){i!=null&&(i.innerHTML=e.step);s.innerHTML=e.intro;f.call(t,e.element,v,c);n.querySelector(".introjs-bullets li > a.active").className="";n.querySelector('.introjs-bullets li > a[data-stepnumber="'+e.step+'"]').className="active";v.style.opacity=1},350)}else{x=document.createElement("div"),T=document.createElement("div"),N=document.createElement("div"),C=document.createElement("div"),k=document.createElement("div"),L=document.createElement("div");x.className="introjs-helperLayer";l.call(t,x);this._targetElement.appendChild(x);T.className="introjs-arrow";C.className="introjs-tooltiptext";C.innerHTML=e.intro;k.className="introjs-bullets";this._options.showBullets===!1&&(k.style.display="none");A=document.createElement("ul");for(E=0,O=this._introItems.length;E<O;E++){M=document.createElement("li");_=document.createElement("a");_.onclick=function(){t.goToStep(this.getAttribute("data-stepnumber"))};E===0&&(_.className="active");_.href="javascript:void(0);";_.innerHTML="&nbsp;";_.setAttribute("data-stepnumber",this._introItems[E].step);M.appendChild(_);A.appendChild(M)}k.appendChild(A);L.className="introjs-tooltipbuttons";this._options.showButtons===!1&&(L.style.display="none");N.className="introjs-tooltip";N.appendChild(C);N.appendChild(k);if(this._options.showStepNumbers==1){D=document.createElement("span");D.className="introjs-helperNumberLayer";D.innerHTML=e.step;x.appendChild(D)}N.appendChild(T);x.appendChild(N);b=document.createElement("a");b.onclick=function(){t._introItems.length-1!=t._currentStep&&o.call(t)};b.href="javascript:void(0);";b.innerHTML=this._options.nextLabel;y=document.createElement("a");y.onclick=function(){t._currentStep!=0&&u.call(t)};y.href="javascript:void(0);";y.innerHTML=this._options.prevLabel;g=document.createElement("a");g.className="introjs-button introjs-skipbutton";g.href="javascript:void(0);";g.innerHTML=this._options.skipLabel;g.onclick=function(){t._introItems.length-1==t._currentStep&&typeof t._introCompleteCallback=="function"&&t._introCompleteCallback.call(t);t._introItems.length-1!=t._currentStep&&typeof t._introExitCallback=="function"&&t._introExitCallback.call(t);a.call(t,t._targetElement)};L.appendChild(g);if(this._introItems.length>1){L.appendChild(y);L.appendChild(b)}N.appendChild(L);f.call(t,e.element,N,T)}if(this._currentStep==0){y.className="introjs-button introjs-prevbutton introjs-disabled";b.className="introjs-button introjs-nextbutton";g.innerHTML=this._options.skipLabel}else if(this._introItems.length-1==this._currentStep){g.innerHTML=this._options.doneLabel;y.className="introjs-button introjs-prevbutton";b.className="introjs-button introjs-nextbutton introjs-disabled"}else{y.className="introjs-button introjs-prevbutton";b.className="introjs-button introjs-nextbutton";g.innerHTML=this._options.skipLabel}b.focus();e.element.className+=" introjs-showElement";P=h(e.element,"position");P!=="absolute"&&P!=="relative"&&(e.element.className+=" introjs-relativePosition");H=e.element.parentNode;while(H!=null){if(H.tagName.toLowerCase()==="body")break;B=h(H,"z-index");/[0-9]+/.test(B)&&(H.className+=" introjs-fixParent");H=H.parentNode}if(!d(e.element)){j=e.element.getBoundingClientRect(),F=p().height,I=j.bottom-(j.bottom-j.top),q=j.bottom-F;I<0||e.element.clientHeight>F?window.scrollBy(0,I-30):window.scrollBy(0,q+100)}}function h(e,t){var n="";e.currentStyle?n=e.currentStyle[t]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t));return n&&n.toLowerCase?n.toLowerCase():n}function p(){var e;if(window.innerWidth!=undefined)return{width:window.innerWidth,height:window.innerHeight};e=document.documentElement;return{width:e.clientWidth,height:e.clientHeight}}function d(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom+80<=window.innerHeight&&t.right<=window.innerWidth}function v(e){var t,n=document.createElement("div"),r="",i=this;n.className="introjs-overlay";if(e.tagName.toLowerCase()==="body"){r+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;";n.setAttribute("style",r)}else{t=m(e);if(t){r+="width: "+t.width+"px; height:"+t.height+"px; top:"+t.top+"px;left: "+t.left+"px;";n.setAttribute("style",r)}}e.appendChild(n);n.onclick=function(){if(i._options.exitOnOverlayClick==1){a.call(i,e);i._introExitCallback!=undefined&&i._introExitCallback.call(i)}};setTimeout(function(){r+="opacity: .8;";n.setAttribute("style",r)},10);return!0}function m(e){var t,n,r={};r.width=e.offsetWidth;r.height=e.offsetHeight;t=0;n=0;while(e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop)){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}r.top=n;r.left=t;return r}function g(e,t){var n,r={};for(n in e)r[n]=e[n];for(n in t)r[n]=t[n];return r}var t,n="0.6.0";t=function(e){if(typeof e=="object")return new r(e);if(typeof e=="string"){var t=document.querySelector(e);if(t)return new r(t);throw new Error("There is no element with given selector.")}return new r(document.body)};t.version=n;t.fn=r.prototype={clone:function(){return new r(this)},setOption:function(e,t){this._options[e]=t;return this},setOptions:function(e){this._options=g(this._options,e);return this},start:function(){i.call(this,this._targetElement);return this},goToStep:function(e){s.call(this,e);return this},exit:function(){a.call(this,this._targetElement)},refresh:function(){l.call(this,document.querySelector(".introjs-helperLayer"));return this},onbeforechange:function(e){if(typeof e!="function")throw new Error("Provided callback for onbeforechange was not a function");this._introBeforeChangeCallback=e;return this},onchange:function(e){if(typeof e!="function")throw new Error("Provided callback for onchange was not a function.");this._introChangeCallback=e;return this},oncomplete:function(e){if(typeof e!="function")throw new Error("Provided callback for oncomplete was not a function.");this._introCompleteCallback=e;return this},onexit:function(e){if(typeof e!="function")throw new Error("Provided callback for onexit was not a function.");this._introExitCallback=e;return this}};e.introJs=t;return t});$(".delete").on("click",function(){return window.confirm("Are you sure you want to delete this?")});$(".btn.edit-user").on("click",function(e){var t,n,r,i,s;e.preventDefault();t=$(this).parents(".dataset");n=t.data("id");r=t.data("name");i=t.data("group");s=$("#editUser");$("#inputEditId").val(n);$("#inputEditName").prop("disabled",!1).val(r);$("#inputEditGroup").prop("disabled",!1);$('#inputEditGroup option[value="'+i+'"]').prop("selected",!0);if(n<3){$("#inputEditName").prop("disabled",!0);$("#inputEditGroup").prop("disabled",!0);n<2&&$("#inputEditPassword").prop("disabled",!0)}s.modal("show")});$(".btn.edit-group").on("click",function(e){var t,n,r,i;e.preventDefault();t=$(this).parents(".dataset");n=t.data("id");r=t.data("name");i=$("#editGroup");$("#inputEditId").val(n);$("#inputEditName").val(r);i.modal("show")});$(".permissions").hide();$(".edit-permissions").on("click",function(){$(this).next(".permissions").toggle()});$(".hover-help").tooltip();$(".hover-help").on("click",function(e){e.preventDefault()});$(".btn-add-dataset").on("click",function(e){var t,n,r,i,s;e.preventDefault();t=$(".tab-pane.active");n=$("form.add-dataset",t);r=t.data("mediatype");i=new Object;s="";$("input, textarea, select",n).each(function(){$(this).attr("name")&&($(this).attr("name")=="collection"?s=$(this).val():$(this).attr("type")=="checkbox"?i[$(this).attr("name")]=$(this).attr("checked")?1:0:i[$(this).attr("name")]=$(this).val())});$.ajax({url:baseURL+"api/definitions/"+s,data:JSON.stringify(i),method:"PUT",headers:{"Content-Type":"application/tdt.definition+json",Authorization:authHeader},success:function(){window.location=baseURL+"api/admin/datasets"},error:function(e){var n;if(e.status!=405){n=JSON.parse(e.responseText);if(n.error&&n.error.message){$(".error .text",t).html(n.error.message);$(".error",t).removeClass("hide").show().focus()}}else window.location=baseURL+"api/admin/datasets"}})});$(".btn-edit-dataset").on("click",function(e){var t,n,r,i,s;e.preventDefault();t=$("form.edit-dataset");n=t.data("mediatype");r=t.data("identifier");i=new Object;s="";$("input, textarea, select",t).each(function(){$(this).attr("name")&&($(this).attr("type")=="checkbox"?i[$(this).attr("name")]=$(this).attr("checked")?1:0:i[$(this).attr("name")]=$(this).val())});$.ajax({url:baseURL+"api/definitions/"+r,data:JSON.stringify(i),method:"POST",headers:{Authorization:authHeader},success:function(){window.location=baseURL+"api/admin/datasets"},error:function(e){var t;if(e.status!=405){t=JSON.parse(e.responseText);if(t.error&&t.error.message){$(".error .text").html(t.error.message);$(".error").removeClass("hide").show().focus()}}else window.location=baseURL+"api/admin/datasets"}})});$(".introjs").on("click",function(e){e.preventDefault();introJs().start()});